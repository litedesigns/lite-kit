{"version":3,"sources":["../src/index.ts","../src/accordion/Accordion.tsx","../src/utils/cn.ts"],"sourcesContent":["// Accordion\nexport { Accordion } from './accordion/Accordion';\nexport type {\n  AccordionProps,\n  AccordionItem,\n  ScrollConfig,\n} from './accordion/types';\n\n// Utilities\nexport { cn } from './utils/cn';\n","'use client';\n\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport { cn } from '../utils/cn';\nimport type { AccordionProps, AccordionItem } from './types';\n\n// Chevron icon component (inline to avoid external dependency)\nfunction ChevronIcon({ className, isOpen }: { className?: string; isOpen: boolean }) {\n  return (\n    <svg\n      className={cn(\n        'lite-kit-accordion-chevron w-5 h-5 flex-shrink-0 transition-transform duration-300',\n        isOpen && 'lite-kit-accordion-chevron--open rotate-180',\n        className\n      )}\n      width=\"20\"\n      height=\"20\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <polyline points=\"6 9 12 15 18 9\" />\n    </svg>\n  );\n}\n\nexport function Accordion({\n  items,\n  mode = 'single',\n  defaultOpen,\n  collapsible = true,\n  scrollDetect = false,\n  scrollConfig = {},\n  className,\n  itemClassName,\n  onValueChange,\n}: AccordionProps) {\n  const {\n    threshold = 0.4,\n    cooldown = 800,\n    scrollToCenter = true,\n    mobileOnly = true,\n    headerOffset = 0,\n  } = scrollConfig;\n\n  // Initialise open state\n  const getInitialOpenIds = (): string[] => {\n    if (!defaultOpen) return [];\n    if (Array.isArray(defaultOpen)) return defaultOpen;\n    return [defaultOpen];\n  };\n\n  const [openIds, setOpenIds] = useState<string[]>(getInitialOpenIds);\n  const [isMobile, setIsMobile] = useState(false);\n  const [manuallySelected, setManuallySelected] = useState(false);\n  const [manuallyClosedId, setManuallyClosedId] = useState<string | null>(null);\n\n  const itemRefs = useRef<(HTMLDivElement | null)[]>([]);\n  const scrollTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const manualTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  // Detect mobile device\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768 || 'ontouchstart' in window);\n    };\n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Determine if scroll detection should be active\n  const isScrollDetectionActive = scrollDetect && (!mobileOnly || isMobile);\n\n  // Handle item toggle\n  const handleToggle = useCallback((item: AccordionItem, index: number) => {\n    const isOpen = openIds.includes(item.id);\n\n    if (isScrollDetectionActive) {\n      // Mark as manually selected to pause scroll detection\n      setManuallySelected(true);\n\n      // Scroll to centre if enabled and opening\n      if (scrollToCenter && !isOpen) {\n        const element = itemRefs.current[index];\n        if (element) {\n          element.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n          });\n        }\n      }\n\n      // Re-enable scroll detection after cooldown\n      if (manualTimeoutRef.current) {\n        clearTimeout(manualTimeoutRef.current);\n      }\n      manualTimeoutRef.current = setTimeout(() => {\n        setManuallySelected(false);\n      }, cooldown);\n    }\n\n    if (isOpen) {\n      // Closing\n      if (collapsible || openIds.length > 1) {\n        if (isScrollDetectionActive) {\n          // Mark as manually closed so scroll won't reopen it\n          setManuallyClosedId(item.id);\n        }\n        const newIds = openIds.filter(id => id !== item.id);\n        setOpenIds(newIds);\n        onValueChange?.(newIds);\n      }\n    } else {\n      // Opening\n      setManuallyClosedId(null);\n\n      if (mode === 'single') {\n        setOpenIds([item.id]);\n        onValueChange?.([item.id]);\n      } else {\n        const newIds = [...openIds, item.id];\n        setOpenIds(newIds);\n        onValueChange?.(newIds);\n      }\n    }\n  }, [openIds, mode, collapsible, isScrollDetectionActive, scrollToCenter, cooldown, onValueChange]);\n\n  // Scroll detection effect - simple viewport centre detection\n  useEffect(() => {\n    if (!isScrollDetectionActive) return;\n\n    const handleScroll = () => {\n      // Reset manual selection after scrolling stops\n      if (scrollTimeoutRef.current) {\n        clearTimeout(scrollTimeoutRef.current);\n      }\n      scrollTimeoutRef.current = setTimeout(() => {\n        setManuallySelected(false);\n      }, 150);\n\n      // Don't override during manual interaction\n      if (manuallySelected) return;\n\n      const viewportHeight = window.innerHeight;\n      const effectiveViewportHeight = viewportHeight - headerOffset;\n      const viewportCenter = headerOffset + effectiveViewportHeight / 2;\n\n      let closestIndex = -1;\n      let closestDistance = Infinity;\n\n      itemRefs.current.forEach((ref, index) => {\n        if (!ref) return;\n        const rect = ref.getBoundingClientRect();\n        const cardCenter = rect.top + rect.height / 2;\n        const distance = Math.abs(cardCenter - viewportCenter);\n\n        if (distance < closestDistance) {\n          closestDistance = distance;\n          closestIndex = index;\n        }\n      });\n\n      // Only expand if the card is reasonably close to centre\n      if (closestIndex >= 0 && closestDistance < effectiveViewportHeight * threshold) {\n        const closestId = items[closestIndex]?.id;\n\n        // If user manually closed a different card, clear that state\n        if (manuallyClosedId !== null && closestId !== manuallyClosedId) {\n          setManuallyClosedId(null);\n        }\n\n        // Don't reopen a manually closed card\n        if (closestId !== manuallyClosedId && closestId !== openIds[0]) {\n          setOpenIds([closestId]);\n          onValueChange?.([closestId]);\n        }\n      }\n    };\n\n    window.addEventListener('scroll', handleScroll, { passive: true });\n    handleScroll(); // Initial check\n\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n      if (scrollTimeoutRef.current) {\n        clearTimeout(scrollTimeoutRef.current);\n      }\n    };\n  }, [isScrollDetectionActive, manuallySelected, manuallyClosedId, items, openIds, threshold, headerOffset, onValueChange]);\n\n  // Cleanup timeouts on unmount\n  useEffect(() => {\n    return () => {\n      if (scrollTimeoutRef.current) clearTimeout(scrollTimeoutRef.current);\n      if (manualTimeoutRef.current) clearTimeout(manualTimeoutRef.current);\n    };\n  }, []);\n\n  return (\n    <div className={cn('lite-kit-accordion space-y-3', className)}>\n      {items.map((item, index) => {\n        const isOpen = openIds.includes(item.id);\n        const Icon = item.icon;\n\n        return (\n          <div\n            key={item.id}\n            ref={(el) => { itemRefs.current[index] = el; }}\n            className={cn(\n              'lite-kit-accordion-item overflow-hidden transition-all duration-300 ease-out',\n              isOpen && 'lite-kit-accordion-item--open',\n              itemClassName\n            )}\n          >\n            {/* Header */}\n            <button\n              type=\"button\"\n              onClick={() => handleToggle(item, index)}\n              className={cn(\n                'lite-kit-accordion-header',\n                'w-full flex items-center gap-4 p-4 text-left cursor-pointer',\n                'transition-colors duration-200 active:scale-[0.99]'\n              )}\n              aria-expanded={isOpen}\n              aria-controls={`accordion-content-${item.id}`}\n            >\n              {/* Icon */}\n              {Icon && (\n                <div\n                  className={cn(\n                    'lite-kit-accordion-icon',\n                    'w-12 h-12 rounded-full flex-shrink-0 flex items-center justify-center',\n                    'transition-all duration-300',\n                    isOpen && 'lite-kit-accordion-icon--active'\n                  )}\n                >\n                  <Icon className=\"lite-kit-accordion-icon-svg w-6 h-6 transition-colors duration-300\" />\n                </div>\n              )}\n\n              {/* Title and subtitle */}\n              <div className=\"lite-kit-accordion-text flex-1 min-w-0\">\n                <h3 className=\"lite-kit-accordion-title font-semibold text-sm\">\n                  {item.title}\n                </h3>\n                {item.subtitle && (\n                  <p\n                    className={cn(\n                      'lite-kit-accordion-subtitle text-xs mt-0.5 transition-colors duration-300',\n                      isOpen && 'lite-kit-accordion-subtitle--active'\n                    )}\n                  >\n                    {item.subtitle}\n                  </p>\n                )}\n              </div>\n\n              {/* Chevron */}\n              <ChevronIcon isOpen={isOpen} className=\"lite-kit-accordion-chevron-icon\" />\n            </button>\n\n            {/* Content */}\n            <div\n              id={`accordion-content-${item.id}`}\n              className={cn(\n                'lite-kit-accordion-content',\n                'overflow-hidden transition-all duration-300 ease-out',\n                isOpen\n                  ? 'lite-kit-accordion-content--open max-h-96 opacity-100'\n                  : 'lite-kit-accordion-content--closed max-h-0 opacity-0'\n              )}\n              role=\"region\"\n              aria-labelledby={`accordion-header-${item.id}`}\n            >\n              <div\n                className={cn(\n                  'lite-kit-accordion-content-inner text-sm leading-relaxed',\n                  Icon ? 'px-4 pb-4 pl-20' : 'px-4 pb-4'\n                )}\n              >\n                {typeof item.content === 'string' ? (\n                  <p>{item.content}</p>\n                ) : (\n                  item.content\n                )}\n              </div>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","/**\n * Utility function for merging class names\n * Filters out falsy values and joins remaining classes\n */\nexport function cn(...classes: (string | undefined | null | false)[]): string {\n  return classes.filter(Boolean).join(' ');\n}\n"],"mappings":"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","names":[]}